# MS Word macros

Растущая коллекция всяких макросов ^^'

## Word Backup

Этот макрос создаёт резервную копию файла перед каждым сохранением. Для этого пользователем определяется каталог для бэкапов, в котором создаются подкаталоги с оптимизированным полным именем сохраняемого файла, в которые, в свою очередь, копируются файлы с датой и временем сохранения.

## Word Insert Plain Text

Этот макрос выполняет простую задачу: вставляет текст без форматирования. Если в буфере обмена будет картинка, то макрос вставит само изображение без связанной информации, которую может добавить, например, броузер.

## Word Russian Grammar Fix

Этот макрос позволяет побороть баг проверки русской орфографии в Word, когда выбранный набор правил (например, для обычной переписки) не сохраняется при перезапуске программы.

## Установка в Normal.dotm

Большинство макросов здесь написаны с расчётом на работу из стандартного шаблона Normal.dot. Однако в версиях Office выше 2003, где стандартный шаблон называется Normal.dotm, возможны проблемы, связанные с работой системы безопасности. Так, после сохранения такого шаблона и открытия нового документа, основанного на нём, Word покажет шаблон так, как если бы в нём не было никакого кода, и макросы работать не будут.

Данное поведение связано с работой системы безопасности. В ряде случаев путь к шаблону Normal.dotm может оказаться исключённым из списка доверенных каталогов. И чтобы исправить это, придётся добавить этот путь самостоятельно.

В разных версиях программы настройки могут выглядеть по-разному, поэтому я опишу процесс исправления в общих чертах.

Для начала нужно войти в настройки Word и отыскать параметры безопасности. Далее нужно найти раздел вида «Надёжные расположения» и добавить в список надёжных каталогов путь к шаблону Normal.dotm. Например, он может быть таким:

> C:\Documents And Settings\Linda\Application Data\Microsoft\Шаблоны

Или таким:

> C:\Users\Linda\AppData\Roaming\Microsoft\Шаблоны

Важно убедиться, что в найденном каталоге действительно присутствует файл Normal.dotm.

После этого потребуется перезапустить Word. Теперь программе будут доступны все макросы из стандартного шаблона.

**Внимание!** Добавляя каталог со стандартным шаблоном в надёжные расположения, вы делаете систему более уязвимой для макровирусов. Убедитесь, что в настройках безопасности установлено включение макросов только по запросу или даже отключено совсем. В этом случае снижается опасность инфицирования стандартного шаблона макро вирусами из принесённых невесть откуда документов.

## Маленький копирайт

1. Программа и исходный код распространяются бесплатно.

2. Вы имеете право распространять их на тех же условиях.

3. Вы не имеете права использовать имя автора после модификации исходного кода.

4. При этом желательно указывать ссылку на автора оригинальной версии исходного кода.

5. Вы не имеете права на платное распространение исходного кода, а также программных модулей, содержащих данный исходнй код.

6. Программа и исходный код распространяются как есть. Автор не несёт ответственности за любые трагедии или несчастные случаи, вызванные использованием программы и исходного кода.

7. Для любого пункта данного соглашения может быть сделано исключение с разрешения автора программы.

8. По любым вопросам, связанным с данной программой, обращайтесь по адресу lindaoneesama@gmail.com